<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="author" content="ATopSoft" />
<meta name="copyright" content="Copyright &copy; 2004-2007, ATopSoft, All Rights Reserved." />
<meta name="rating" content="Safe For Kids" />
<meta name="keywords" lang="en" content="meta key" />
<meta name="description" content="meta desc" />

<title>Win32 CodeHook</title>
<style type="text/css">@import url('page.css');</style>
<link rel="stylesheet" type="text/css" href="page.css" />
</head>


<body>
<div class="header">
</div>
<div class="container">
	<div class="mainbox">
		 <div class="nav"><ul>
<li><a href="index.html">Introduction</a></li>
<li><a href="start.html">Get start</a></li>
<li><a href="api-icodehook.html">Interface - ICodeHook</a></li>
<li><a href="api-icodehookhelper.html">Interface - ICodeHookHelper</a></li>
<li><a href="api-idirectcodehook.html">Interface - IDirectCodeHook</a></li>
<li><a href="api-ierrorcodehook.html">Interface - IErrorCodeHook</a></li>
<li><a href="compare-raw-advanced-mode.html">Comparison of raw mode and advanced mode</a></li>
<li><a href="tutorial.html">Tutorials</a></li>
<li><a href="faq.html">FAQ</a></li>
<li><a href="support.html">Support</a></li>
<li><a href="version.html">Credits and Versions</a></li>

</ul>

		 </div>
		 <div class="content"><div class="plist">
<h3>Glossary and terms:</h3>
<h5>1, Target, or target function, or target method, or target procedure</h5>
The code address or function to be hooked. <br />
<br />

<h5>2, Hook, or hook function, or hook method, or hook procedure</h5>
The code address or function to intercept the target. <br />
<br />

<h5>3, Caller, or caller function, or caller method, or caller procedure</h5>
Sames as calling function. <br />
The code address or function which is invoking another function. <br />
<br />

<h5>4, Calling convention</h5>
The convention of which register used to pass parameters, the order that the parameters are pushed on the stack, and who (the calling or called function) cleans the stack. <br />
<br />

<h5>5, "this" pointer</h5>
Known as "Self" pointer in Delphi. A pointer to an object instance itself.
<br />

<h5>6, Raw mode hooking, or low level hooking</h5>
Win32 CodeHook connects your hook function to the target function directly. <br />
It's your responsibility to deal with the calling convention, prototype of the target and hook function. <br />
Usually this method requires the hook function has exactly same prototype with the target. <br />
<br />

<h5>7, Advanced mode hooking, or high level hooking</h5>
Win32 CodeHook generates a piece of thumb code (bridge code), then connects your hook function to the target function via the bridge code. <br />
<br />

<h5>8, Extra parameters.</h5>
In advanced hooking, you can specify some extra parameters to the hook function. This feature is very useful to use an object function (class member function) as a hook because you can pass 'Self' pointer ('this' pointer, in C++) as an extra parameter.<br />
<br />

<h5>9, Global function.</h5>
The functions declared in the global scope, not in any class. For instance, all Win32 APIs exported by Windows user32.dll are global function. <br />
<br />

<h5>10, Object function, or class member function.</h5>
The functions declared in a class or interface. For instance, all functions declared in an interface is object function. <br />
Such functions require a "this" pointer. <br />
For Delphi users, the class functions should be treated as object functions because they require "Self". <br />
<br />

<h3>Start hooking</h3>

<h5>Get the root hook interface (ICodeHook)</h5>
Win32 CodeHook exposes all functions in interfaces. <br />
You can obtain the root interface through the API GetCodeHook to get the global interface. <br />
You can read the <a href="tutorial.html#get-root-intf">tutorial</a> for more information. <br />
<br />

<h5>Get other hook interfaces</h5>
All other non-root interfaces can be obtained from the root interface. Use ICodeHook.GetDirectCodeHook to get IDirectCodeHook, and ICodeHook.GetCodeHookHelper to get ICodeHookHelper. <br />
<br />

<h3>Interfaces overview:</h3>

<h5>ICodeHook</h5>
The kernel interface that supports both raw mode and advanced mode hooking. <br />
<br />

<h5>ICodeHookHelper</h5>
A wrapper interface of ICodeHook. This interface make it's more easier to use ICodeHook. <br />
<br />

<h5>IDirectCodeHook</h5>
Low level (raw mode) hook. Usually you don't need this interface. Use ICodeHook instead. <br />
<br />

<h5>IErrorCodeHook</h5>
Get the error code and error message. <br />
<br />

</div>

		 </div>
	</div>
</div>
<div class="footer">Copyright &copy; 2008, Wang Qi, All Rights Reserved.
</div>
</body>
</html>
